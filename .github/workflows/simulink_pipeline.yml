name: Parallel Generated Workflow 
on: # You must define at least one trigger for each workflow.
  workflow_dispatch:  # Set manual triggers as an optional trigger.
  pull_request:     # Set pull_request as an automatic trigger. 
                    # By default, a pull_request runs when a pull_request 
                    # event's activity type is opened, synchronize, or reopened
    # opened: This triggers the workflow when a pull request is initially opened.
    # synchronize: This triggers the workflow when new commits are pushed to a pull request branch. This includes any time the pull request's head branch is updated with new commits.
    # reopened: This triggers the workflow when a previously closed pull request is reopened
    types: [opened, synchronize, reopened]

jobs:
  # ir_dag:
  #   runs-on: ${{ vars.RUNNER_LABEL }}
  #   steps:
  #     - name: Checkout code
  #       uses: actions/checkout@v4
  #       with:
  #         path: ${{ vars.SCM_FOLDER || 'scm' }}
  #         submodules: ${{ vars.SUBMODULES_MODE || 'false' }}
  
  #     - name: Copy ir_dag and pipeline
  #       run: |
  #         cp scm/pipelines/static/ir_dag.json scm/ir_dag.json
  #         cp scm/.github/workflows/simulink_pipeline.yml scm/simulink_pipeline.yml

  #     - name: Upload ir_dag
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: ir_dag
  #         path: |
  #           scm/ir_dag.json
  #           scm/simulink_pipeline.yml
    
  start:
    needs: [ir_dag]
    uses: ./.github/workflows/generic-job.yml
    with:
      job-name: start 
  
  padv_builtin_task_CollectMetrics_AHRS_Voter:
    needs: [start]
    uses: ./.github/workflows/generic-job.yml
    with:
      job-name: padv_builtin_task_CollectMetrics_AHRS_Voter 
  
  padv_builtin_task_CollectMetrics_Actuator_Control:
    needs: [start]
    uses: ./.github/workflows/generic-job.yml
    with:
      job-name: padv_builtin_task_CollectMetrics_Actuator_Control 
  
  padv_builtin_task_CollectMetrics_Flight_Control:
    needs: [start]
    uses: ./.github/workflows/generic-job.yml
    with:
      job-name: padv_builtin_task_CollectMetrics_Flight_Control 
  
  padv_builtin_task_CollectMetrics_InnerLoop_Control:
    needs: [start]
    uses: ./.github/workflows/generic-job.yml
    with:
      job-name: padv_builtin_task_CollectMetrics_InnerLoop_Control 
  
  padv_builtin_task_CollectMetrics_OuterLoop_Control:
    needs: [start]
    uses: ./.github/workflows/generic-job.yml
    with:
      job-name: padv_builtin_task_CollectMetrics_OuterLoop_Control 
  
  end:
    needs: [padv_builtin_task_CollectMetrics_AHRS_Voter, padv_builtin_task_CollectMetrics_Actuator_Control, padv_builtin_task_CollectMetrics_Flight_Control, padv_builtin_task_CollectMetrics_InnerLoop_Control, padv_builtin_task_CollectMetrics_OuterLoop_Control]
    uses: ./.github/workflows/generic-job.yml
    with:
      job-name: end 